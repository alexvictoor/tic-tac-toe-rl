(window["webpackJsonptic-tac-toe-rl"]=window["webpackJsonptic-tac-toe-rl"]||[]).push([[0],{11:function(e,t,r){e.exports=r(18)},16:function(e,t,r){},17:function(e,t,r){},18:function(e,t,r){"use strict";r.r(t);var a=r(0),n=r.n(a),i=r(9),o=r.n(i),u=(r(16),r(4)),l=r(2),s=r(3),c=r(6),h=r(5),y=r(7),m=(r(17),r(1)),v=r(10),f=function(){function e(){Object(l.a)(this,e),this.currentPlayer="Player1",this.board=[".",".",".",".",".",".",".",".","."],this.lastPlay=-1,this.hasWon=this.hasWon.bind(this)}return Object(s.a)(e,[{key:"clone",value:function(){var t=new e;return t.currentPlayer=this.currentPlayer,t.board=Object(v.a)(this.board),t}},{key:"getCurrentPlayer",value:function(){return this.board.filter(function(e){return"x"===e}).length>this.board.filter(function(e){return"o"===e}).length?"Player2":"Player1"}},{key:"getPlayerMark",value:function(e){return"Player1"===e?"x":"o"}},{key:"play",value:function(e){var t=this.getPlayerMark(this.currentPlayer);if(!this.whereToPlay().includes(e))throw new Error("Not a valid play");var r=this.clone();return r.board[e]=t,r.currentPlayer=r.getCurrentPlayer(),r.lastPlay=e,r}},{key:"getPossibleOutcomes",value:function(){var e=this;return this.whereToPlay().map(function(t){return[t,e.play(t)]})}},{key:"whereToPlay",value:function(){return this.board.map(function(e,t){return[e,t]}).filter(function(e){var t=Object(m.a)(e,2),r=t[0];t[1];return"."===r}).map(function(e){var t=Object(m.a)(e,2);t[0];return t[1]})}},{key:"drawnGame",value:function(){return 0===this.whereToPlay().length}},{key:"isOver",value:function(){return!!this.getWinner()||this.drawnGame()}},{key:"hasWon",value:function(t){var r=this,a=this.getPlayerMark(t);return e.lines.some(function(e){return e.every(function(e){return r.board[e]===a})})}},{key:"getWinner",value:function(){var e=this;return["Player1","Player2"].find(function(t){return e.hasWon(t)})}},{key:"toString",value:function(){return this.board.join("")}}],[{key:"fromString",value:function(t){var r=new e;return r.board=t.split(" ").join("").split(""),r.currentPlayer=r.getCurrentPlayer(),r}}]),e}();f.lines=[[0,1,2],[3,4,5],[6,7,8],[0,3,6],[1,4,7],[2,5,8],[0,4,8],[2,4,6]];var d=function(){function e(t,r,a){Object(l.a)(this,e),this.player=t,this.alpha=r,this.explorationFactor=a,this.formerState=void 0,this.qualities=void 0,this.getQuality=this.getQuality.bind(this),this.play=this.play.bind(this),this.qualities={}}return Object(s.a)(e,[{key:"startNewGame",value:function(){this.formerState=void 0}},{key:"play",value:function(e){if(e.isOver())return this.formerState&&this.learn(this.formerState,e,-1),e;var t=this.chooseAction(e);return this.formerState&&this.learn(this.formerState,e,t),this.formerState=[e,t],e.play(t)}},{key:"learn",value:function(e,t,r){var a=Object(m.a)(e,2),n=a[0],i=a[1],o=this.getQuality(n.toString()+i),u=this.getQuality(t.toString()+r),l=this.computeReward(t),s=o+this.alpha*(l+u-o);this.qualities[n.toString()+i]=s}},{key:"computeReward",value:function(e){var t=e.getWinner();return t?t===this.player?100:-100:e.drawnGame()?10:0}},{key:"getQuality",value:function(e){return this.qualities[e]||0}},{key:"chooseAction",value:function(e){var t=this,r=e.getPossibleOutcomes(),a=r.find(function(e){var r=Object(m.a)(e,2);r[0];return r[1].getWinner()===t.player});if(a){var n=Object(m.a)(a,2),i=n[0];n[1];return i}var o=e.toString(),u=r.map(function(e){var t=Object(m.a)(e,2),r=t[0];t[1];return[r,o+String(r)]}).map(function(e){var r=Object(m.a)(e,2),a=r[0],n=r[1];return[a,t.getQuality(n)]}).sort(function(e,t){return t[1]-e[1]}).map(function(e){var t=Object(m.a)(e,2),r=t[0];t[1];return r});return Math.random()<this.explorationFactor?u[Math.floor(Math.random()*u.length)]:u[0]}}]),e}(),g=function(e,t){for(var r=[e.play,t.play],a=new f,n=[a],i=new Date,o=function(e){return e<4e3?.6:e<2e4/3?.4:e<1e4?.2:0},u=function(e){return e>19999&&n.pop()||a},l=0;l<2e4||n.length>0;){l++,e.startNewGame(),t.startNewGame();var s=o(l);e.explorationFactor=s,t.explorationFactor=s;for(var c=u(l),h=0;!c.isOver();){var y=r[h%2];h>0&&Math.random()>.66&&l<2e4&&n.push(c),c=y(c),h++}c=(0,r[h%2])(c)}e.explorationFactor=0,t.explorationFactor=0,console.log("Training took ".concat((new Date).getTime()-i.getTime(),"ms")),console.log("Games played",l)};function p(e){return n.a.createElement("button",{className:"square",onClick:e.onClick},e.value)}var b=function(e){function t(){return Object(l.a)(this,t),Object(c.a)(this,Object(h.a)(t).apply(this,arguments))}return Object(y.a)(t,e),Object(s.a)(t,[{key:"renderSquare",value:function(e){var t=this;return n.a.createElement(p,{value:this.props.squares[e],onClick:function(){return t.props.onClick(e)}})}},{key:"render",value:function(){return n.a.createElement("div",null,n.a.createElement("div",{className:"board-row"},this.renderSquare(0),this.renderSquare(1),this.renderSquare(2)),n.a.createElement("div",{className:"board-row"},this.renderSquare(3),this.renderSquare(4),this.renderSquare(5)),n.a.createElement("div",{className:"board-row"},this.renderSquare(6),this.renderSquare(7),this.renderSquare(8)))}}]),t}(n.a.Component),k=function(e){function t(e){var r;Object(l.a)(this,t),r=Object(c.a)(this,Object(h.a)(t).call(this,e));var a=new d("Player1",.3,.2),n=new d("Player2",.3,.2),i=new f;return r.state={history:[{squares:Array(9).fill(null),game:i}],stepNumber:0,trainingDone:!1,player2Agent:n.play},r.triggerPlayer2Agent=r.triggerPlayer2Agent.bind(Object(u.a)(r)),setTimeout(function(){g(a,n),r.setState({trainingDone:!0})}),r}return Object(y.a)(t,e),Object(s.a)(t,[{key:"handleClick",value:function(e){var t=this.state.history.slice(0,this.state.stepNumber+1),r=t[t.length-1].game,a="Player1"===r.currentPlayer;if(!r.isOver()&&r.whereToPlay().includes(e)&&a){var n=r.play(e);this.updateGameState(a,e,n,this.triggerPlayer2Agent)}}},{key:"triggerPlayer2Agent",value:function(e){var t=this.state.player2Agent(e);e.isOver()||this.updateGameState(!1,t.lastPlay,t)}},{key:"updateGameState",value:function(e,t,r,a){var n=this.state.history.slice(0,this.state.stepNumber+1),i=n[n.length-1].squares.slice();i[t]=e?"X":"O",this.setState({history:n.concat([{game:r,squares:i}]),stepNumber:n.length},a&&function(){a(r)})}},{key:"jumpTo",value:function(e){this.setState({stepNumber:e})}},{key:"render",value:function(){var e=this;if(!this.state.trainingDone)return n.a.createElement("div",null,"Machine is learning how to play...",n.a.createElement("br",null),"This might take a few seconds");var t,r=this.state.history,a=r[this.state.stepNumber],i=a.game,o=i.getWinner(),u=r.map(function(t,r){var a=r?"Go to move #"+r:"Go to game start";return n.a.createElement("li",{key:r},n.a.createElement("button",{onClick:function(){return e.jumpTo(r)}},a))});return t=o?"Winner: "+o:"Next player: "+i.currentPlayer,n.a.createElement("div",{className:"game"},n.a.createElement("div",{className:"game-board"},n.a.createElement(b,{squares:a.squares,onClick:function(t){return e.handleClick(t)}})),n.a.createElement("div",{className:"game-info"},n.a.createElement("div",null,t),n.a.createElement("ol",null,u)))}}]),t}(n.a.Component),w=function(){return n.a.createElement("div",{className:"App"},n.a.createElement(k,null))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(n.a.createElement(w,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[11,1,2]]]);
//# sourceMappingURL=main.b20fdc32.chunk.js.map